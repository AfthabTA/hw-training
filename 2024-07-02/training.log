did some minor adjustments to the code 
decreased the running time from 1 hour to 10-15 minutes
learned and practiced regx 